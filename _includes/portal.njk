---
layout: base
---

<div class="portal-container bg-white dark:bg-gray-900 min-h-screen" role="region">
  <div class="portal-layout-wrapper max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
    <!-- Two-column layout for larger screens -->
    <div class="portal-content-wrapper">
      <!-- Left Sidebar Navigation -->  
      <aside id="portal-sidebar" class="portal-sidebar" role="complementary" aria-label="Portal navigation">
        <div class="portal-sidebar-inner bg-emerald-700 dark:bg-emerald-800 rounded-lg shadow-md p-5 text-white" style="background-color: #047857 !important;">
          <nav role="navigation" aria-labelledby="portal-nav-heading">
            <h2 id="portal-nav-heading" class="text-lg font-bold mb-4 text-white">Portal Menu</h2>
            <ul class="space-y-1" role="list">
              <li role="listitem">
                <a href="/dashboard/" 
                   class="flex items-center px-4 py-2 rounded-md 
                   {% if page.url == '/dashboard/' %}bg-white bg-opacity-20 font-bold text-va-primary{% else %}text-white hover:bg-white hover:bg-opacity-10{% endif %}" 
                   aria-current="{% if page.url == '/dashboard/' %}page{% else %}false{% endif %}">
                  <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                  </svg>
                  Dashboard
                </a>
              </li>
              <li role="listitem">
                <a href="/portal_values_assessment/" 
                   class="flex items-center px-4 py-2 rounded-md transition-all duration-200 
                   {% if page.url == '/portal_values_assessment/' %}bg-white bg-opacity-20 font-bold text-va-primary{% else %}text-white hover:bg-white hover:bg-opacity-10{% endif %}" 
                   aria-current="{% if page.url == '/portal_values_assessment/' %}page{% else %}false{% endif %}">
                   <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                   </svg>
                   Values Assessment
                </a>
              </li>
              <li role="listitem">
                <a href="/portal_exercises/" 
                   class="flex items-center px-4 py-2 rounded-md transition-all duration-200 
                   {% if page.url == '/portal_exercises/' %}bg-white bg-opacity-20 font-bold text-va-primary{% else %}text-white hover:bg-white hover:bg-opacity-10{% endif %}" 
                   aria-current="{% if page.url == '/portal_exercises/' %}page{% else %}false{% endif %}">
                   <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>
                   </svg>
                   Exercises
                </a>
              </li>
              <li role="listitem">
                <a href="/portal_reflection/" 
                   class="flex items-center px-4 py-2 rounded-md transition-all duration-200 
                   {% if page.url == '/portal_reflection/' %}bg-white bg-opacity-20 font-bold text-va-primary{% else %}text-white hover:bg-white hover:bg-opacity-10{% endif %}" 
                   aria-current="{% if page.url == '/portal_reflection/' %}page{% else %}false{% endif %}">
                   <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                   </svg>
                   Reflection
                </a>
              </li>
              <li role="listitem">
                <a href="/portal_journal/" 
                   class="flex items-center px-4 py-2 rounded-md transition-all duration-200 
                   {% if page.url == '/portal_journal/' %}bg-white bg-opacity-20 font-bold text-va-primary{% else %}text-white hover:bg-white hover:bg-opacity-10{% endif %}" 
                   aria-current="{% if page.url == '/portal_journal/' %}page{% else %}false{% endif %}">
                   <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                   </svg>
                   Journal
                </a>
              </li>
              <li role="listitem">
                <a href="/portal_acts/" 
                   class="flex items-center px-4 py-2 rounded-md transition-all duration-200 
                   {% if page.url == '/portal_acts/' %}bg-white bg-opacity-20 font-bold text-va-primary{% else %}text-white hover:bg-white hover:bg-opacity-10{% endif %}" 
                   aria-current="{% if page.url == '/portal_acts/' %}page{% else %}false{% endif %}">
                   <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                   </svg>
                   Value-Based Acts
                </a>
              </li>
              <li role="listitem">
                <a href="/portal_progress/" 
                   class="flex items-center px-4 py-2 rounded-md transition-all duration-200 
                   {% if page.url == '/portal_progress/' %}bg-white bg-opacity-20 font-bold text-va-primary{% else %}text-white hover:bg-white hover:bg-opacity-10{% endif %}" 
                   aria-current="{% if page.url == '/portal_progress/' %}page{% else %}false{% endif %}">
                   <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                   </svg>
                   Progress
                </a>
              </li>
              <li role="listitem">
                <a href="/portal_account/" 
                   class="flex items-center px-4 py-2 rounded-md transition-all duration-200 
                   {% if page.url == '/portal_account/' %}bg-white bg-opacity-20 font-bold text-va-primary{% else %}text-white hover:bg-white hover:bg-opacity-10{% endif %}" 
                   aria-current="{% if page.url == '/portal_account/' %}page{% else %}false{% endif %}">
                   <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                   </svg>
                   Account
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </aside>
      
      <!-- Main Content Area -->
      <main class="portal-content" role="main">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 sm:p-8 mt-2">
          {{ content | safe }}
        </div>
      </main>
    </div>
  </div>
</div>

{# Portal-specific scripts #}
<script src="/js/sidebar-sticky.js"></script>
<script src="/js/user-menu.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  console.log('[Portal Template] Portal layout loaded');
  
  // Initialize public page navigation mobile menu
  const publicMobileMenuButton = document.getElementById('public-mobile-menu-button');
  const publicMobileMenu = document.getElementById('public-mobile-menu');
  
  if (publicMobileMenuButton && publicMobileMenu) {
    // Track menu state
    let publicMenuOpen = false;
    
    // Toggle function for mobile menu
    function togglePublicMobileMenu() {
      publicMenuOpen = !publicMenuOpen;
      
      // Update ARIA attributes for accessibility
      publicMobileMenuButton.setAttribute('aria-expanded', publicMenuOpen ? 'true' : 'false');
      
      // Toggle visibility of menu
      if (publicMenuOpen) {
        publicMobileMenu.classList.remove('hidden');
        
        // Toggle between hamburger and X icons
        publicMobileMenuButton.querySelector('svg.block').classList.add('hidden');
        publicMobileMenuButton.querySelector('svg.block').classList.remove('block');
        publicMobileMenuButton.querySelector('svg.hidden').classList.add('block');
        publicMobileMenuButton.querySelector('svg.hidden').classList.remove('hidden');
      } else {
        publicMobileMenu.classList.add('hidden');
        
        // Toggle between hamburger and X icons
        publicMobileMenuButton.querySelector('svg.block').classList.add('hidden');
        publicMobileMenuButton.querySelector('svg.block').classList.remove('block');
        publicMobileMenuButton.querySelector('svg:not(.block)').classList.add('block');
        publicMobileMenuButton.querySelector('svg:not(.block)').classList.remove('hidden');
      }
    }
    
    // Add click event listener
    publicMobileMenuButton.addEventListener('click', togglePublicMobileMenu);
    
    // Close menu when clicking outside
    document.addEventListener('click', function(event) {
      if (publicMenuOpen && !publicMobileMenu.contains(event.target) && !publicMobileMenuButton.contains(event.target)) {
        togglePublicMobileMenu();
      }
    });
  }
});
</script>
